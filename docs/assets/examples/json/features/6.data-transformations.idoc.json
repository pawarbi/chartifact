{
  "$schema": "https://microsoft.github.io/chartifact/schema/idoc_v1.json",
  "title": "Feature: Data Transformations",
  "dataLoaders": [
    {
      "dataSourceName": "rawData",
      "type": "inline",
      "format": "json",
      "content": [
        {
          "name": "Product A",
          "category": "Electronics",
          "price": 299,
          "inStock": true
        },
        {
          "name": "Product B",
          "category": "Electronics",
          "price": 199,
          "inStock": false
        },
        {
          "name": "Product C",
          "category": "Clothing",
          "price": 49,
          "inStock": true
        },
        {
          "name": "Product D",
          "category": "Clothing",
          "price": 79,
          "inStock": true
        },
        {
          "name": "Product E",
          "category": "Books",
          "price": 15,
          "inStock": true
        }
      ],
      "dataFrameTransformations": [
        {
          "type": "filter",
          "expr": "datum.inStock && datum.price <= maxPrice"
        }
      ]
    }
  ],
  "variables": [
    {
      "variableId": "maxPrice",
      "type": "number",
      "initialValue": 100
    },
    {
      "variableId": "categoryStats",
      "type": "object",
      "isArray": true,
      "initialValue": [],
      "calculation": {
        "dependsOn": [
          "rawData"
        ],
        "dataFrameTransformations": [
          {
            "type": "aggregate",
            "groupby": [
              "category"
            ],
            "ops": [
              "count",
              "mean"
            ],
            "fields": [
              "name",
              "price"
            ],
            "as": [
              "count",
              "avgPrice"
            ]
          }
        ]
      }
    }
  ],
  "groups": [
    {
      "groupId": "main",
      "elements": [
        "## Data Transformations\nUse data transformations to filter, aggregate, and manipulate data.",
        {
          "type": "slider",
          "variableId": "maxPrice",
          "label": "Maximum price filter:",
          "min": 0,
          "max": 500,
          "step": 10
        },
        "### Filtered Products (in stock, price â‰¤ ${{maxPrice}})",
        {
          "type": "tabulator",
          "dataSourceName": "rawData"
        },
        "### Category Statistics",
        {
          "type": "tabulator",
          "dataSourceName": "categoryStats"
        }
      ]
    }
  ]
}